<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Awatif Components - Loads - Point Load</title>
    <style>
      body {
        margin: 0;
      }

      #controls {
        position: absolute;
        top: 20px;
        left: 20px;
        background: rgba(255, 255, 255, 0.9);
        padding: 15px;
        border-radius: 8px;
        z-index: 1000;
      }
    </style>
  </head>
  <body>
    <script type="module">
      import van from "vanjs-core";
      import { render } from "lit-html";
      import { pointLoad } from "./pointLoad.ts";
      import { getViewer } from "../../../ui/viewer/getViewer.ts";
      import { templates } from "../../templates.ts";

      const params = van.state(pointLoad.defaultParams);

      // Control panel
      const controls = document.createElement("div");
      controls.id = "controls";

      van.derive(() => {
        render(pointLoad.getParamsTemplate({ params }), controls);
      });

      // Geometry with points for load application
      const geometry = {
        points: van.state(
          new Map([
            [1, [-2, 0, 0]],
            [2, [0, 2, 0]],
            [3, [2, 0, 0]],
          ])
        ),
        lines: van.state(
          new Map([
            [1, [1, 2]],
            [2, [2, 3]],
          ])
        ),
        visible: van.state(true),
        selection: van.state(null),
      };

      // Components with load applied to point 2
      const components = van.state(
        new Map([
          [
            "LOADS",
            [
              {
                name: "Point Load Demo",
                templateIndex: 0,
                geometry: [2],
                params: params.val,
              },
            ],
          ],
        ])
      );

      // Update components when params change
      van.derive(() => {
        components.val = new Map([
          [
            "LOADS",
            [
              {
                name: "Point Load Demo",
                templateIndex: 0,
                geometry: [2],
                params: params.val,
              },
            ],
          ],
        ]);
      });

      document.body.append(getViewer({ geometry, components }), controls);
    </script>
  </body>
</html>
