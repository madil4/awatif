import{v as c,C as h,L as d,M as B,b,B as V,c as E,D as k,F as w,U as D,g as L,a as S}from"./styles-CVhKyYX7.js";import{g as A}from"./getParameters-BO171xuA.js";import{m as T}from"./mesh-CnAvVJ0J.js";import{n as N,s as H}from"./pureFunctionsAny.generated-BITz6FsS.js";import"./complex-i8qiIvCl.js";function R(o,t=8){const e=document.createElement("div");e.id="legend";const n=Array.from({length:t+1},(r,i)=>i/t).reverse();let s,a;return n.forEach((r,i)=>{s=document.createElement("div"),s.id=`marker-${i}`,s.className="marker",s.style.marginTop=i==0?"0px":`calc(${50/t}vh - 1px)`,a=document.createElement("p"),a.id=`marker-text-${i}`,s.append(a),e.append(s)}),setTimeout(()=>{c.derive(()=>{n.forEach((r,i)=>{a=document.getElementById(`marker-text-${i}`),a.innerText=$(o.val,r).toString()})})}),e}function $(o,t){const e=Math.max(...o)-Math.min(...o);return(Math.min(...o)+t*e).toPrecision(3)}class j{constructor(t,e=32){this.isLut=!0,this.lut=[],this.map=[],this.n=0,this.minV=0,this.maxV=1,this.setColorMap(t,e)}set(t){return t.isLut===!0&&this.copy(t),this}setMin(t){return this.minV=t,this}setMax(t){return this.maxV=t,this}setColorMap(t,e=32){this.map=F[t]||F.rainbow,this.n=e;const n=1/this.n,s=new h,a=new h;this.lut.length=0,this.lut.push(new h(this.map[0][1]));for(let r=1;r<e;r++){const i=r*n;for(let m=0;m<this.map.length-1;m++)if(i>this.map[m][0]&&i<=this.map[m+1][0]){const p=this.map[m][0],u=this.map[m+1][0];s.setHex(this.map[m][1],d),a.setHex(this.map[m+1][1],d);const l=new h().lerpColors(s,a,(i-p)/(u-p));this.lut.push(l)}}return this.lut.push(new h(this.map[this.map.length-1][1])),this}copy(t){return this.lut=t.lut,this.map=t.map,this.n=t.n,this.minV=t.minV,this.maxV=t.maxV,this}getColor(t){t=B.clamp(t,this.minV,this.maxV),t=(t-this.minV)/(this.maxV-this.minV);const e=Math.round(t*this.n);return this.lut[e]}addColorMap(t,e){return F[t]=e,this}createCanvas(){const t=document.createElement("canvas");return t.width=1,t.height=this.n,this.updateCanvas(t),t}updateCanvas(t){const e=t.getContext("2d",{alpha:!1}),n=e.getImageData(0,0,1,this.n),s=n.data;let a=0;const r=1/this.n,i=new h,m=new h,p=new h;for(let u=1;u>=0;u-=r)for(let l=this.map.length-1;l>=0;l--)if(u<this.map[l][0]&&u>=this.map[l-1][0]){const C=this.map[l-1][0],v=this.map[l][0];i.setHex(this.map[l-1][1],d),m.setHex(this.map[l][1],d),p.lerpColors(i,m,(u-C)/(v-C)),s[a*4]=Math.round(p.r*255),s[a*4+1]=Math.round(p.g*255),s[a*4+2]=Math.round(p.b*255),s[a*4+3]=255,a+=1}return e.putImageData(n,0,0),t}}const F={rainbow:[[0,255],[.2,65535],[.5,65280],[.8,16776960],[1,16711680]],cooltowarm:[[0,3952322],[.2,10206463],[.5,14474460],[.8,16163717],[1,11797542]],blackbody:[[0,0],[.2,7864320],[.5,15086080],[.8,16776960],[1,16777215]],grayscale:[[0,0],[.2,4210752],[.5,8355712],[.8,12566463],[1,16777215]]};function G(o,t,e){const n=new j,s=new h,a=new b(new V,new E({side:k,vertexColors:!0}));n.setColorMap("rainbow"),a.renderOrder=-1,a.geometry.setAttribute("position",new w(o.flat(),3)),a.geometry.setIndex(new D(t.flat(),1)),a.geometry.setAttribute("color",new w(o.map(()=>[0,0,0]).flat(),3)),n.setMax(Math.max(...e)),n.setMin(Math.min(...e));for(let r=0;r<e.length;r++)s.copy(n.getColor(e[r])).convertSRGBToLinear(),s.multiplyScalar(.6),a.geometry.attributes.color.setXYZ(r,s.r,s.g,s.b);return a}const M={boundary:{value:c.state(10),min:1,max:10,step:.1,label:"Boundary point"}},x=c.state([]),g=c.state([]),y=c.state([new b]),f=c.state([0]);c.derive(()=>{const o=[M.boundary.value.val,0,3],t=c.state([[0,0,0],[5,0,0],o,[8,0,7],[15,0,5],[15,0,0],[20,0,0],[20,0,10],[0,0,10],[0,0,0],[5,0,5]]),e=c.state([0,1,2,3,4,5,6,7,8]),{nodes:n,elements:s}=T({points:t,polygon:e,maxMeshSize:1});x.val=n.val,g.val=s.val,f.val=P(o,x.val),y.val=[G(x.val,g.val,f.val)]});document.body.append(A(M),L({structure:{nodes:x,elements:g},objects3D:y}),R(f),S({sourceCode:"https://github.com/madil4/awatif/blob/main/examples/src/color-map/main.ts",author:"https://www.linkedin.com/in/siu-kai-cheung/"}));function P(o,t){return t.map(e=>N(H(e,o)))}
