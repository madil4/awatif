import{w as T,v as f,b as A,L as B,B as D,c as M,F as O,g as j,a as L}from"./styles-fAu9ATwT.js";import{g as z}from"./getDialog-BoDfFnoY.js";function C({fields:r,data:a,onChange:t}){const i=document.createElement("div"),n=new T({name:Math.random().toString().substring(2),box:i,selectType:"cell",recordHeight:26,show:{columnMenu:!1,lineNumbers:!0},columns:F(r),records:v(a.rawVal,r)});return i.setAttribute("id","grid"),new ResizeObserver(()=>n.refresh()).observe(i),n.onChange=e=>{if(!r[e.detail.column])return;const o=b[e.detail.column];n.records[e.detail.index][o]=e.detail.value.new,t&&t(m(n.records,r))},n.onDelete=e=>{e.detail.force=!0,e.onComplete=()=>{t&&t(m(n.records,r))}},n.onPaste=e=>{e.onComplete=()=>{n.mergeChanges(),t&&t(m(n.records,r))}},f.derive(()=>{n.records=v(a.val,r),n.refresh()}),i}const b="ABCDEFGHIJKLMNOPRST";function F(r){return b.split("").map(t=>({field:t,text:'<div style="text-align: center">'+t+"</div>",size:"90px",resizable:!0,sortable:!0,editable:{type:"text"}})).map(t=>{const i=r.find(n=>n.field===t.field);return i?{...t,...i}:t})}function v(r,a){const t=Array.isArray(r)?r:l(r,a),i=Array(50).fill(0).map((e,o)=>({recid:o})),n=b.split("");for(let e=0;e<t.length;e++)for(let o=0;o<t[e].length;o++)i[e][n[o]]=t[e][o];return i;function l(e,o){const s=new Map;return o.forEach(c=>s.set(c.field,c)),Object.keys(e).map(c=>[s.get(c).text,e[c]])}}function m(r,a){if(b.includes(a[0].field))return i(r,a);return n(r,a);function i(l,e){let o=[...Array(l.length)].map(()=>[...Array(e.length)]);const s=b.split("");for(let u=0;u<o.length;u++)for(let d=0;d<o[u].length;d++)o[u][d]=l[u][s[d]]??"";return o.slice(0,c(o)+1);function c(u){for(let d=u.length-1;d>=0;d--)if(u[d].some(E=>E!==""))return d}}function n(l,e){return Object.fromEntries(e.map(({field:o},s)=>[o,l[s].B]))}}function G({tables:r,onChange:a}){const t=document.createElement("div"),i=document.createElement("div"),n=[],l=new Map;r.forEach((s,c)=>{n.push({id:c,text:s.text}),l.set(c,C({fields:s.fields,data:s.data,onChange:o}))});const e=new A({box:i,name:"tabs",active:n[0].id,flow:"up",tabs:n});t.id="tables",i.id="tabs",t.append(l.values().next().value,i),e.onClick=s=>{t.firstChild.replaceWith(l.get(s.target))};function o(s){a&&a({table:e.active,data:s})}return t}const g=f.state([[0,0,0],[5,0,5],[10,0,0]]),w=new B(new D,new M),p=f.state([w]),y=new Map;y.set("polyline",{text:"Polyline",fields:[{field:"A",text:"X-coordinate",min:"25",editable:{type:"float"}},{field:"B",text:"Y-coordinate",editable:{type:"float"}},{field:"C",text:"Z-coordinate",editable:{type:"float"}}],data:g});const I=({data:r})=>g.val=r;f.derive(()=>{w.geometry.setAttribute("position",new O(g.val.flat(),3)),p.val=[...p.rawVal]});const h=f.state(""),x=f.state(void 0);f.derive(()=>{h.val==="Tables"&&(x.val=G({tables:y,onChange:I}))});document.body.append(j({clickedButton:h,buttons:["Tables"]}),z({dialogBody:x}),L({objects3D:p}));
